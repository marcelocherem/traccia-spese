<!-- resume week -->
<div class="total-week">
  <div class="infos">
    <div class="container-info">
      <h2 class="container-text">Limite</h2>
      <div class="value">
        <%= limit.toFixed(2) %> €
      </div>
    </div>
    <div class="container-info <%= remaining < 0 ? 'negative' : 'positive' %>">
      <h2 class="container-text">Libero</h2>
      <div class="value">
        <%= remaining.toFixed(2) %> €

      </div>
    </div>
    <div class="container-info">
      <h2 class="container-text">Speso</h2>
      <div class="value">
        <%= total.toFixed(2) %> €

      </div>
    </div>
  </div>
</div>
<main>
  <section id="home">
  <div class="title">
    <h2 class="title-name">Transazioni - <%= weekLabel %>
    </h2>
    <button class="new-spese plus-btn"></button>
  </div>
  <!-- expenses list -->
  <div class="cycle-block">
    <% expenses.forEach(item=> { %>
      <div class="entry entry-bills">
        <div class="icon-circle">
          <img src="/images/down.svg" alt="" class="icon">
        </div>
        <div class="income-text">
          <h2 class="expense-name">
            <%= item.name %>
          </h2>
          <h2 class="expense-value">
            <%= item.value.toFixed(2) %> €
          </h2>
        </div>
        <div class="actions">
          <button class="edit-btn" data-id="<%= item.id %>" data-name="<%= item.name %>" data-value="<%= item.value %>"
            data-date="<%= item.date_expense ? item.date_expense.toISOString().split('T')[0] : '' %>">
            <img class="icon-edit" src="images/edit.svg" alt="">
          </button>
          <form action="/delete-weekly_expenses/<%= item.id %>" method="POST" class="delete-form"
            style="display:inline;">
            <button type="submit" class="delete-btn">
              <img class="icon-edit" src="images/delete.svg" alt="">
            </button>
          </form>
        </div>
      </div>
      <div class="separator"></div>
    <% }) %>
    <!-- rettifica set. -->
    <% if (showRetifica) { %>
      <div class="retifica-info entry entry-bills">
        <div class="icon-circle">
          <img class="icon" src="/images/history.svg" alt="">
        </div>
        <div class="income-text">
          <h2>Rettifica sett. precedente</h2>
          <h2>
            <%= retificaValue.toFixed(2) %> €
          </h2>
        </div>
      </div>
      <div class="separator"></div>
      <% } %>
  </div>

  <!-- add new expense -->
  <div class="container-plus-btn hidden">
    <div class="container">
      <form action="/add-weekly_expenses" method="POST" class="form-incomes">
        <label for="name">Nome</label>
        <input type="text" name="name" placeholder="Scrivi il nome" required>
        <label for="value">Valore</label>
        <input type="number" name="value" step="0.01" placeholder="Scrivi il valore (€)" required>
        <label for="date_expense">Data della spesa</label>
        <input type="date" name="date_expense" required>
        <button type="submit" class="submit-btn">Aggiungi</button>
      </form>
    </div>
  </div>

  <!-- edit expenses -->
  <div class="container-edit-btn hidden">
    <div class="container">
      <form id="edit-weekly-form" method="POST" class="form-incomes">
        <label for="edit-name">Nome</label>
        <input type="text" name="name" id="edit-name" required>
        <label for="edit-value">Valore</label>
        <input type="number" name="value" step="0.01" id="edit-value" required>
        <label for="edit-date">Data della spesa</label>
        <input type="date" name="date_expense" id="edit-date" required>
        <div class="btn-container">
          <button type="button"
            onclick="document.querySelector('#home .container-edit-btn').classList.add('hidden')">Annulla</button>
          <button type="submit" class="submit-btn">Salva</button>
        </div>
      </form>
    </div>
  </div>
</section>